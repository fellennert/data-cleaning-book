<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data cleaning for social scientists - 4&nbsp; Manipulation with dplyr</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./forcats.html" rel="next">
<link href="./tidy-data.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Manipulation with <code>dplyr</code></span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data cleaning for social scientists</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./projects.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">RStudio Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./readr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reading in data with <code>readr</code> (et al.)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidy-data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tidy data with <code>tidyr</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dplyr.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Manipulation with <code>dplyr</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forcats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Factors with <code>forcats</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lubridate.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Dates with <code>lubridate</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggplot2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualizations with <code>ggplot2</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#working-with-the-main-verbs" id="toc-working-with-the-main-verbs" class="nav-link active" data-scroll-target="#working-with-the-main-verbs"><span class="toc-section-number">4.1</span>  Working with the main “verbs”</a>
  <ul class="collapse">
  <li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select"><span class="toc-section-number">4.1.1</span>  <code>select()</code></a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter"><span class="toc-section-number">4.1.2</span>  <code>filter()</code></a></li>
  <li><a href="#mutate" id="toc-mutate" class="nav-link" data-scroll-target="#mutate"><span class="toc-section-number">4.1.3</span>  <code>mutate()</code></a></li>
  <li><a href="#summarize-and-group_by" id="toc-summarize-and-group_by" class="nav-link" data-scroll-target="#summarize-and-group_by"><span class="toc-section-number">4.1.4</span>  <code>summarize()</code> and <code>group_by</code></a></li>
  <li><a href="#arrange" id="toc-arrange" class="nav-link" data-scroll-target="#arrange"><span class="toc-section-number">4.1.5</span>  <code>arrange()</code></a></li>
  </ul></li>
  <li><a href="#introducing-joins" id="toc-introducing-joins" class="nav-link" data-scroll-target="#introducing-joins"><span class="toc-section-number">4.2</span>  Introducing <code>joins</code></a>
  <ul class="collapse">
  <li><a href="#multiple-types-of-units-are-in-the-same-table" id="toc-multiple-types-of-units-are-in-the-same-table" class="nav-link" data-scroll-target="#multiple-types-of-units-are-in-the-same-table"><span class="toc-section-number">4.2.1</span>  Multiple types of units are in the same table</a></li>
  <li><a href="#one-unit-is-in-multiple-tables" id="toc-one-unit-is-in-multiple-tables" class="nav-link" data-scroll-target="#one-unit-is-in-multiple-tables"><span class="toc-section-number">4.2.2</span>  One unit is in multiple tables</a></li>
  <li><a href="#left_join-and-right_join" id="toc-left_join-and-right_join" class="nav-link" data-scroll-target="#left_join-and-right_join"><span class="toc-section-number">4.2.3</span>  <code>left_join()</code> and <code>right_join()</code></a></li>
  <li><a href="#inner_join" id="toc-inner_join" class="nav-link" data-scroll-target="#inner_join"><span class="toc-section-number">4.2.4</span>  <code>inner_join()</code></a></li>
  <li><a href="#full_join" id="toc-full_join" class="nav-link" data-scroll-target="#full_join"><span class="toc-section-number">4.2.5</span>  <code>full_join()</code></a></li>
  <li><a href="#semi_join" id="toc-semi_join" class="nav-link" data-scroll-target="#semi_join"><span class="toc-section-number">4.2.6</span>  <code>semi_join()</code></a></li>
  <li><a href="#anti_join" id="toc-anti_join" class="nav-link" data-scroll-target="#anti_join"><span class="toc-section-number">4.2.7</span>  <code>anti_join()</code></a></li>
  <li><a href="#bind_rows-and-bind_cols" id="toc-bind_rows-and-bind_cols" class="nav-link" data-scroll-target="#bind_rows-and-bind_cols"><span class="toc-section-number">4.2.8</span>  <code>bind_rows()</code> and <code>bind_cols()</code></a></li>
  </ul></li>
  <li><a href="#further-links" id="toc-further-links" class="nav-link" data-scroll-target="#further-links"><span class="toc-section-number">4.3</span>  Further links</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="wrangling" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Manipulation with <code>dplyr</code></span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>The last chapter showed you four things: how you get data sets into R, a couple of ways to create tibbles, how to pass data to functions using the pipe (<code>|&gt;</code>), and an introduction to tidy data and how to make data sets tidy using the <code>tidyr</code> package <span class="citation" data-cites="wickham_tidyr_2020">(<a href="references.html#ref-wickham_tidyr_2020" role="doc-biblioref">Wickham 2020b</a>)</span>. What you haven’t learned was how you can actually manipulate the data itself. In the <code>tidyverse</code> framework <span class="citation" data-cites="wickham_welcome_2019">(<a href="references.html#ref-wickham_welcome_2019" role="doc-biblioref">Wickham et al. 2019</a>)</span>, the package which enables you to accomplish those tasks is <code>dplyr</code> <span class="citation" data-cites="wickham_dplyr_2020">(<a href="references.html#ref-wickham_dplyr_2020" role="doc-biblioref">Wickham 2020a</a>)</span>.</p>
<p><code>dplyr</code> joined the party in 2014, building upon the <code>plyr</code> package. The d in <code>dplyr</code> stands for data set and <code>dplyr</code> works with tibbles (or data frames) only.</p>
<p>It consists of five main functions, the “verbs”:</p>
<ul>
<li><code>arrange()</code> – sort values</li>
<li><code>filter()</code> – pick observations</li>
<li><code>mutate()</code> – create new variables (columns)</li>
<li><code>select()</code> – select variables</li>
<li><code>summarize()</code> – create summaries from multiple values</li>
</ul>
<p>They are joined by <code>group_by()</code>, a function that changes the scope on which entities the functions are applied to.</p>
<p>Furthermore, diverse <code>bind_</code> functions and <code>_join</code>s enable you to combine multiple tibbles into one. They will be introduced later.</p>
<section id="working-with-the-main-verbs" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="working-with-the-main-verbs"><span class="header-section-number">4.1</span> Working with the main “verbs”</h2>
<p>In the following, I will guide you through how you can use the verbs to accomplish whatever goals which require data wrangling you might have.</p>
<p>The data set I will use here consists of the 1,000 most popular movies on IMDb which were published between 2006 and 2016 and some data on them. It was created by PromptCloud and DataStock and published on Kaggle, more information can be found <a href="https://www.kaggle.com/PromptCloudHQ/imdb-data">here</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>imdb_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://www.dropbox.com/s/wfwyxjkpo24e3yq/imdb2006-2016.csv?dl=1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data set hasn’t been modified by me before. I will show you how I would go across it using a couple of <code>dplyr</code> functions.</p>
<section id="select" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="select"><span class="header-section-number">4.1.1</span> <code>select()</code></h3>
<p><code>select</code> enables you to <em>select</em> columns. Since we are dealing with tidy data, every variable has its own column.</p>
<p><code>glimpse()</code> provides you with an overview of the data set and its columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(imdb_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,000
Columns: 12
$ Rank                 &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15…
$ Title                &lt;chr&gt; "Guardians of the Galaxy", "Prometheus", "Split",…
$ Genre                &lt;chr&gt; "Action,Adventure,Sci-Fi", "Adventure,Mystery,Sci…
$ Description          &lt;chr&gt; "A group of intergalactic criminals are forced to…
$ Director             &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan…
$ Actors               &lt;chr&gt; "Chris Pratt, Vin Diesel, Bradley Cooper, Zoe Sal…
$ Year                 &lt;dbl&gt; 2014, 2012, 2016, 2016, 2016, 2016, 2016, 2016, 2…
$ `Runtime (Minutes)`  &lt;dbl&gt; 121, 124, 117, 108, 123, 103, 128, 89, 141, 116, …
$ Rating               &lt;dbl&gt; 8.1, 7.0, 7.3, 7.2, 6.2, 6.1, 8.3, 6.4, 7.1, 7.0,…
$ Votes                &lt;dbl&gt; 757074, 485820, 157606, 60545, 393727, 56036, 258…
$ `Revenue (Millions)` &lt;dbl&gt; 333.13, 126.46, 138.12, 270.32, 325.02, 45.13, 15…
$ Metascore            &lt;dbl&gt; 76, 65, 62, 59, 40, 42, 93, 71, 78, 41, 66, 74, 6…</code></pre>
</div>
</div>
<p>The columns I want to keep are: <code>Title</code>, <code>Director</code>, <code>Year</code>, <code>Runtime (Minutes)</code>, <code>Rating</code>, <code>Votes</code>, and <code>Revenue (Millions)</code>. Furthermore, I want to rename the columns: every column’s name should be in lowercase and a regular name that does not need to be surrounded by back ticks – i.e., a name that only consists of characters, numbers, underscores, or dots.</p>
<p>This can be achieved in a couple of ways:</p>
<p>First, by choosing the columns column by column and subsequently renaming them:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>imdb_raw <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Title, Director, Year, <span class="st">`</span><span class="at">Runtime (Minutes)</span><span class="st">`</span>, Rating, Votes, <span class="st">`</span><span class="at">Revenue (Millions)</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">title =</span> Title, <span class="at">director =</span> Director, <span class="at">year =</span> Year, <span class="at">runtime =</span> <span class="st">`</span><span class="at">Runtime (Minutes)</span><span class="st">`</span>, <span class="at">rating =</span> Rating, <span class="at">votes =</span> Votes, <span class="at">revenue_million =</span> <span class="st">`</span><span class="at">Revenue (Millions)</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,000
Columns: 7
$ title           &lt;chr&gt; "Guardians of the Galaxy", "Prometheus", "Split", "Sin…
$ director        &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan", "C…
$ year            &lt;dbl&gt; 2014, 2012, 2016, 2016, 2016, 2016, 2016, 2016, 2016, …
$ runtime         &lt;dbl&gt; 121, 124, 117, 108, 123, 103, 128, 89, 141, 116, 133, …
$ rating          &lt;dbl&gt; 8.1, 7.0, 7.3, 7.2, 6.2, 6.1, 8.3, 6.4, 7.1, 7.0, 7.5,…
$ votes           &lt;dbl&gt; 757074, 485820, 157606, 60545, 393727, 56036, 258682, …
$ revenue_million &lt;dbl&gt; 333.13, 126.46, 138.12, 270.32, 325.02, 45.13, 151.06,…</code></pre>
</div>
</div>
<p>Second, the columns can also be chosen vice versa: unnecessary columns can be dropped using a minus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>imdb_raw <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Rank, <span class="sc">-</span>Genre, <span class="sc">-</span>Description, <span class="sc">-</span>Actors, <span class="sc">-</span>Metascore) <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">title =</span> Title, <span class="at">director =</span> Director, <span class="at">year =</span> Year, <span class="at">runtime =</span> <span class="st">`</span><span class="at">Runtime (Minutes)</span><span class="st">`</span>, <span class="at">rating =</span> Rating, <span class="at">votes =</span> Votes, <span class="at">revenue_million =</span> <span class="st">`</span><span class="at">Revenue (Millions)</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,000
Columns: 7
$ title           &lt;chr&gt; "Guardians of the Galaxy", "Prometheus", "Split", "Sin…
$ director        &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan", "C…
$ year            &lt;dbl&gt; 2014, 2012, 2016, 2016, 2016, 2016, 2016, 2016, 2016, …
$ runtime         &lt;dbl&gt; 121, 124, 117, 108, 123, 103, 128, 89, 141, 116, 133, …
$ rating          &lt;dbl&gt; 8.1, 7.0, 7.3, 7.2, 6.2, 6.1, 8.3, 6.4, 7.1, 7.0, 7.5,…
$ votes           &lt;dbl&gt; 757074, 485820, 157606, 60545, 393727, 56036, 258682, …
$ revenue_million &lt;dbl&gt; 333.13, 126.46, 138.12, 270.32, 325.02, 45.13, 151.06,…</code></pre>
</div>
</div>
<p>Columns can also be renamed in the selecting process:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>imdb_raw <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">title =</span> Title, <span class="at">director =</span> Director, <span class="at">year =</span> Year, <span class="at">runtime =</span> <span class="st">`</span><span class="at">Runtime (Minutes)</span><span class="st">`</span>, <span class="at">rating =</span> Rating, <span class="at">votes =</span> Votes, <span class="at">revenue_million =</span> <span class="st">`</span><span class="at">Revenue (Millions)</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,000
Columns: 7
$ title           &lt;chr&gt; "Guardians of the Galaxy", "Prometheus", "Split", "Sin…
$ director        &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan", "C…
$ year            &lt;dbl&gt; 2014, 2012, 2016, 2016, 2016, 2016, 2016, 2016, 2016, …
$ runtime         &lt;dbl&gt; 121, 124, 117, 108, 123, 103, 128, 89, 141, 116, 133, …
$ rating          &lt;dbl&gt; 8.1, 7.0, 7.3, 7.2, 6.2, 6.1, 8.3, 6.4, 7.1, 7.0, 7.5,…
$ votes           &lt;dbl&gt; 757074, 485820, 157606, 60545, 393727, 56036, 258682, …
$ revenue_million &lt;dbl&gt; 333.13, 126.46, 138.12, 270.32, 325.02, 45.13, 151.06,…</code></pre>
</div>
</div>
<p>You can also make your expressions shorter by using a couple of hacks:</p>
<p><code>:</code> can be used to select all columns between two:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>imdb_raw <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Title, Director, Year<span class="sc">:</span><span class="st">`</span><span class="at">Revenue (Millions)</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">title =</span> Title, <span class="at">director =</span> Director, <span class="at">year =</span> Year, <span class="at">runtime =</span> <span class="st">`</span><span class="at">Runtime (Minutes)</span><span class="st">`</span>, <span class="at">rating =</span> Rating, <span class="at">votes =</span> Votes, <span class="at">revenue_million =</span> <span class="st">`</span><span class="at">Revenue (Millions)</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,000
Columns: 7
$ title           &lt;chr&gt; "Guardians of the Galaxy", "Prometheus", "Split", "Sin…
$ director        &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan", "C…
$ year            &lt;dbl&gt; 2014, 2012, 2016, 2016, 2016, 2016, 2016, 2016, 2016, …
$ runtime         &lt;dbl&gt; 121, 124, 117, 108, 123, 103, 128, 89, 141, 116, 133, …
$ rating          &lt;dbl&gt; 8.1, 7.0, 7.3, 7.2, 6.2, 6.1, 8.3, 6.4, 7.1, 7.0, 7.5,…
$ votes           &lt;dbl&gt; 757074, 485820, 157606, 60545, 393727, 56036, 258682, …
$ revenue_million &lt;dbl&gt; 333.13, 126.46, 138.12, 270.32, 325.02, 45.13, 151.06,…</code></pre>
</div>
</div>
<p><code>starts_with()</code> select columns whose names start with the same character string:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="ot">&lt;-</span> imdb_raw <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Title, Director, Votes, Year, <span class="fu">starts_with</span>(<span class="st">"R"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Rank) <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">title =</span> Title, <span class="at">director =</span> Director, <span class="at">year =</span> Year, <span class="at">runtime =</span> <span class="st">`</span><span class="at">Runtime (Minutes)</span><span class="st">`</span>, <span class="at">rating =</span> Rating, <span class="at">votes =</span> Votes, <span class="at">revenue_million =</span> <span class="st">`</span><span class="at">Revenue (Millions)</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,000
Columns: 7
$ title           &lt;chr&gt; "Guardians of the Galaxy", "Prometheus", "Split", "Sin…
$ director        &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan", "C…
$ votes           &lt;dbl&gt; 757074, 485820, 157606, 60545, 393727, 56036, 258682, …
$ year            &lt;dbl&gt; 2014, 2012, 2016, 2016, 2016, 2016, 2016, 2016, 2016, …
$ runtime         &lt;dbl&gt; 121, 124, 117, 108, 123, 103, 128, 89, 141, 116, 133, …
$ rating          &lt;dbl&gt; 8.1, 7.0, 7.3, 7.2, 6.2, 6.1, 8.3, 6.4, 7.1, 7.0, 7.5,…
$ revenue_million &lt;dbl&gt; 333.13, 126.46, 138.12, 270.32, 325.02, 45.13, 151.06,…</code></pre>
</div>
</div>
<p>As you may have noticed, the order in the <code>select()</code> matters: columns will be ordered in the same order as they are chosen.</p>
<p>A couple of further shortcuts for <code>select()</code> do exist. An overview can be found in the <a href="https://github.com/rstudio/cheatsheets/blob/master/data-transformation.pdf"><code>dplyr</code> cheatsheet</a>.</p>
</section>
<section id="filter" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="filter"><span class="header-section-number">4.1.2</span> <code>filter()</code></h3>
<p>Whereas <code>select()</code> enables you to choose variables (i.e., columns), <code>filter()</code> lets you choose observations (i.e., rows).</p>
<p>In this case, I only want movies with a revenue above $100,000,000:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(revenue_million <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 250
Columns: 7
$ title           &lt;chr&gt; "Guardians of the Galaxy", "Prometheus", "Split", "Sin…
$ director        &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan", "C…
$ votes           &lt;dbl&gt; 757074, 485820, 157606, 60545, 393727, 258682, 192177,…
$ year            &lt;dbl&gt; 2014, 2012, 2016, 2016, 2016, 2016, 2016, 2016, 2016, …
$ runtime         &lt;dbl&gt; 121, 124, 117, 108, 123, 128, 116, 133, 127, 133, 107,…
$ rating          &lt;dbl&gt; 8.1, 7.0, 7.3, 7.2, 6.2, 8.3, 7.0, 7.5, 7.8, 7.9, 7.7,…
$ revenue_million &lt;dbl&gt; 333.13, 126.46, 138.12, 270.32, 325.02, 151.06, 100.01…</code></pre>
</div>
</div>
<p>Besides, I am especially interested in the director Christopher Nolan. Therefore, I want to look at movies that were directed by him and made more than $100,000,000:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(revenue_million <span class="sc">&gt;</span> <span class="dv">100</span> <span class="sc">&amp;</span> director <span class="sc">==</span> <span class="st">"Christopher Nolan"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4
Columns: 7
$ title           &lt;chr&gt; "Interstellar", "The Dark Knight", "Inception", "The D…
$ director        &lt;chr&gt; "Christopher Nolan", "Christopher Nolan", "Christopher…
$ votes           &lt;dbl&gt; 1047747, 1791916, 1583625, 1222645
$ year            &lt;dbl&gt; 2014, 2008, 2010, 2012
$ runtime         &lt;dbl&gt; 169, 152, 148, 164
$ rating          &lt;dbl&gt; 8.6, 9.0, 8.8, 8.5
$ revenue_million &lt;dbl&gt; 187.99, 533.32, 292.57, 448.13</code></pre>
</div>
</div>
<p>The following overview is taken from the <a href="https://github.com/rstudio/cheatsheets/blob/master/data-transformation.pdf"><code>dplyr</code> cheatsheet</a> and shows the operators you can use in <code>filter()</code>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/operators.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Overview of comparison operators</figcaption><p></p>
</figure>
</div>
<section id="exemplary-application" class="level4" data-number="4.1.2.1">
<h4 data-number="4.1.2.1" class="anchored" data-anchor-id="exemplary-application"><span class="header-section-number">4.1.2.1</span> Exemplary application</h4>
<p>To demonstrate how a real-world application of this stuff could look like, I will now provide you a brief insight into my private life and how I organize movie nights. JK. You could definitely try this at home and surprise your loved ones with such hot applications. If you are brave and surprise your latest Tinder match with an .RDS file containing suggestions for Netflix&amp;Chill, please let me know what their response looked like.</p>
<p>Tonight, I will hang out with a real nerd. Probably because they (nerds have all kinds of genders) know about my faible for R, they have sent me a vector containing a couple of movies we could watch tonight:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># guarantees that movie_vec will always be the same thing</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>movie_vec <span class="ot">&lt;-</span> imdb_raw<span class="sc">$</span>Title[<span class="fu">sample</span>(<span class="dv">1000</span>, <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>movie_vec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Mechanic: Resurrection" "Denial"                 "The Conjuring 2"       
 [4] "Birth of the Dragon"    "Warrior"                "Super"                 
 [7] "127 Hours"              "Dangal"                 "The Infiltrator"       
[10] "Maleficent"            </code></pre>
</div>
</div>
<p>However, I want to make a more informed decision and decide to obtain some more information on the movies from my IMDb data set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(title <span class="sc">%in%</span> movie_vec) <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 10
Columns: 7
$ title           &lt;chr&gt; "Dangal", "The Conjuring 2", "Warrior", "Maleficent", …
$ director        &lt;chr&gt; "Nitesh Tiwari", "James Wan", "Gavin O'Connor", "Rober…
$ votes           &lt;dbl&gt; 48969, 137203, 355722, 268877, 43929, 48161, 8229, 552…
$ year            &lt;dbl&gt; 2016, 2016, 2011, 2014, 2016, 2016, 2016, 2016, 2010, …
$ runtime         &lt;dbl&gt; 161, 134, 140, 97, 127, 98, 109, 103, 94, 96
$ rating          &lt;dbl&gt; 8.8, 7.4, 8.2, 7.0, 7.1, 5.6, 6.6, 3.9, 7.6, 6.8
$ revenue_million &lt;dbl&gt; 11.15, 102.46, 13.65, 241.41, 15.43, 21.20, 4.07, 93.0…</code></pre>
</div>
</div>
<p>I have convinced them to watch either one of the movies they have suggested or one directed by Christopher Nolan or one with a rating greater or equal to 8.5 and send them back this data set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(title <span class="sc">%in%</span> movie_vec <span class="sc">|</span> director <span class="sc">==</span> <span class="st">"Christopher Nolan"</span> <span class="sc">|</span> rating <span class="sc">&gt;=</span> <span class="fl">8.5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 21
Columns: 7
$ title           &lt;chr&gt; "Interstellar", "The Dark Knight", "The Prestige", "In…
$ director        &lt;chr&gt; "Christopher Nolan", "Christopher Nolan", "Christopher…
$ votes           &lt;dbl&gt; 1047747, 1791916, 913152, 1583625, 34110, 937414, 4896…
$ year            &lt;dbl&gt; 2014, 2008, 2006, 2010, 2016, 2006, 2016, 2012, 2014, …
$ runtime         &lt;dbl&gt; 169, 152, 130, 148, 106, 151, 161, 164, 107, 134, 140,…
$ rating          &lt;dbl&gt; 8.6, 9.0, 8.5, 8.8, 8.6, 8.5, 8.8, 8.5, 8.5, 7.4, 8.2,…
$ revenue_million &lt;dbl&gt; 187.99, 533.32, 53.08, 292.57, 4.68, 132.37, 11.15, 44…</code></pre>
</div>
</div>
<p>“I deteste ‘Interstellar’,” is the response. “All right,” I say to myself, “I can easily exclude it.”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(title <span class="sc">%in%</span> movie_vec <span class="sc">|</span> director <span class="sc">==</span> <span class="st">"Christopher Nolan"</span> <span class="sc">|</span> rating <span class="sc">&gt;=</span> <span class="fl">8.5</span> <span class="sc">&amp;</span> title <span class="sc">!=</span> <span class="st">"Interstellar"</span>) <span class="sc">|&gt;</span> <span class="co"># if you want to negate something, put the ! in front of it</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 21
Columns: 7
$ title           &lt;chr&gt; "Interstellar", "The Dark Knight", "The Prestige", "In…
$ director        &lt;chr&gt; "Christopher Nolan", "Christopher Nolan", "Christopher…
$ votes           &lt;dbl&gt; 1047747, 1791916, 913152, 1583625, 34110, 937414, 4896…
$ year            &lt;dbl&gt; 2014, 2008, 2006, 2010, 2016, 2006, 2016, 2012, 2014, …
$ runtime         &lt;dbl&gt; 169, 152, 130, 148, 106, 151, 161, 164, 107, 134, 140,…
$ rating          &lt;dbl&gt; 8.6, 9.0, 8.5, 8.8, 8.6, 8.5, 8.8, 8.5, 8.5, 7.4, 8.2,…
$ revenue_million &lt;dbl&gt; 187.99, 533.32, 53.08, 292.57, 4.68, 132.37, 11.15, 44…</code></pre>
</div>
</div>
<p>Oh, that did not work. I should wrap them in columns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((title <span class="sc">%in%</span> movie_vec <span class="sc">|</span> director <span class="sc">==</span> <span class="st">"Christopher Nolan"</span> <span class="sc">|</span> rating <span class="sc">&gt;=</span> <span class="fl">8.5</span>) <span class="sc">&amp;</span> title <span class="sc">!=</span> <span class="st">"Interstellar"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 20
Columns: 7
$ title           &lt;chr&gt; "The Dark Knight", "The Prestige", "Inception", "Kimi …
$ director        &lt;chr&gt; "Christopher Nolan", "Christopher Nolan", "Christopher…
$ votes           &lt;dbl&gt; 1791916, 913152, 1583625, 34110, 937414, 48969, 122264…
$ year            &lt;dbl&gt; 2008, 2006, 2010, 2016, 2006, 2016, 2012, 2014, 2016, …
$ runtime         &lt;dbl&gt; 152, 130, 148, 106, 151, 161, 164, 107, 134, 140, 97, …
$ rating          &lt;dbl&gt; 9.0, 8.5, 8.8, 8.6, 8.5, 8.8, 8.5, 8.5, 7.4, 8.2, 7.0,…
$ revenue_million &lt;dbl&gt; 533.32, 53.08, 292.57, 4.68, 132.37, 11.15, 448.13, 13…</code></pre>
</div>
</div>
<p>They come up with a new idea: we have a Scottish evening with a movie directed by the Scottish director Gillies MacKinnon:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(director <span class="sc">==</span> <span class="st">"Gillies MacKinnon"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 7
$ title           &lt;chr&gt; "Whisky Galore"
$ director        &lt;chr&gt; "Gillies MacKinnon"
$ votes           &lt;dbl&gt; 102
$ year            &lt;dbl&gt; 2016
$ runtime         &lt;dbl&gt; 98
$ rating          &lt;dbl&gt; 5
$ revenue_million &lt;dbl&gt; NA</code></pre>
</div>
</div>
<p>“Well, apparently there is a problem in the data set,” I notice. “There is an NA in the revenue column. I should probably have a further look at this.”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(revenue_million)) <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 128
Columns: 7
$ title           &lt;chr&gt; "Mindhorn", "Hounds of Love", "Paris pieds nus", "5- 2…
$ director        &lt;chr&gt; "Sean Foley", "Ben Young", "Dominique Abel", "Patrick …
$ votes           &lt;dbl&gt; 2490, 1115, 222, 241, 496, 5103, 987, 35870, 149791, 7…
$ year            &lt;dbl&gt; 2016, 2016, 2016, 2007, 2016, 2016, 2016, 2016, 2016, …
$ runtime         &lt;dbl&gt; 89, 108, 83, 113, 73, 91, 130, 86, 133, 106, 105, 118,…
$ rating          &lt;dbl&gt; 6.4, 6.7, 6.8, 7.1, 2.7, 5.6, 3.7, 6.8, 5.9, 7.9, 5.8,…
$ revenue_million &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</code></pre>
</div>
</div>
<p>Well, that’s quite a significant number of NAs. I will need to exclude these cases:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(revenue_million)) <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 872
Columns: 7
$ title           &lt;chr&gt; "Guardians of the Galaxy", "Prometheus", "Split", "Sin…
$ director        &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan", "C…
$ votes           &lt;dbl&gt; 757074, 485820, 157606, 60545, 393727, 56036, 258682, …
$ year            &lt;dbl&gt; 2014, 2012, 2016, 2016, 2016, 2016, 2016, 2016, 2016, …
$ runtime         &lt;dbl&gt; 121, 124, 117, 108, 123, 103, 128, 141, 116, 133, 127,…
$ rating          &lt;dbl&gt; 8.1, 7.0, 7.3, 7.2, 6.2, 6.1, 8.3, 7.1, 7.0, 7.5, 7.8,…
$ revenue_million &lt;dbl&gt; 333.13, 126.46, 138.12, 270.32, 325.02, 45.13, 151.06,…</code></pre>
</div>
</div>
</section>
<section id="other-possibilities-to-subset-observations" class="level4" data-number="4.1.2.2">
<h4 data-number="4.1.2.2" class="anchored" data-anchor-id="other-possibilities-to-subset-observations"><span class="header-section-number">4.1.2.2</span> Other possibilities to subset observations</h4>
<p><code>slice()</code> selects rows by positions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 10
Columns: 7
$ title           &lt;chr&gt; "Guardians of the Galaxy", "Prometheus", "Split", "Sin…
$ director        &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan", "C…
$ votes           &lt;dbl&gt; 757074, 485820, 157606, 60545, 393727, 56036, 258682, …
$ year            &lt;dbl&gt; 2014, 2012, 2016, 2016, 2016, 2016, 2016, 2016, 2016, …
$ runtime         &lt;dbl&gt; 121, 124, 117, 108, 123, 103, 128, 89, 141, 116
$ rating          &lt;dbl&gt; 8.1, 7.0, 7.3, 7.2, 6.2, 6.1, 8.3, 6.4, 7.1, 7.0
$ revenue_million &lt;dbl&gt; 333.13, 126.46, 138.12, 270.32, 325.02, 45.13, 151.06,…</code></pre>
</div>
</div>
<p><code>distinct</code> removes duplicate rows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(director) <span class="sc">|&gt;</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 644
Columns: 1
$ director &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan", "Christop…</code></pre>
</div>
</div>
<p>By default, it will remove all other columns apart from the one(s) you have specified. You can avoid that by setting <code>.keep_all = TRUE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(title, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 999
Columns: 7
$ title           &lt;chr&gt; "Guardians of the Galaxy", "Prometheus", "Split", "Sin…
$ director        &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan", "C…
$ votes           &lt;dbl&gt; 757074, 485820, 157606, 60545, 393727, 56036, 258682, …
$ year            &lt;dbl&gt; 2014, 2012, 2016, 2016, 2016, 2016, 2016, 2016, 2016, …
$ runtime         &lt;dbl&gt; 121, 124, 117, 108, 123, 103, 128, 89, 141, 116, 133, …
$ rating          &lt;dbl&gt; 8.1, 7.0, 7.3, 7.2, 6.2, 6.1, 8.3, 6.4, 7.1, 7.0, 7.5,…
$ revenue_million &lt;dbl&gt; 333.13, 126.46, 138.12, 270.32, 325.02, 45.13, 151.06,…</code></pre>
</div>
</div>
<p>Oh, interesting, there is apparently one movie which is in there twice. How could we find this movie?</p>
</section>
</section>
<section id="mutate" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="mutate"><span class="header-section-number">4.1.3</span> <code>mutate()</code></h3>
<p>My data set looks pretty nice already, but one flaw catches the eye: the column <code>revenue_million</code> should probably be converted to <code>revenue</code>. Hence, I need to create a new variable which contains the values from <code>revenue_million</code> multiplied by 1,000,000 and drop the now obsolete <code>revenue_million</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">revenue =</span> revenue_million <span class="sc">*</span> <span class="dv">1000000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>revenue_million) <span class="sc">|&gt;</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,000
Columns: 7
$ title    &lt;chr&gt; "Guardians of the Galaxy", "Prometheus", "Split", "Sing", "Su…
$ director &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan", "Christop…
$ votes    &lt;dbl&gt; 757074, 485820, 157606, 60545, 393727, 56036, 258682, 2490, 7…
$ year     &lt;dbl&gt; 2014, 2012, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2…
$ runtime  &lt;dbl&gt; 121, 124, 117, 108, 123, 103, 128, 89, 141, 116, 133, 127, 13…
$ rating   &lt;dbl&gt; 8.1, 7.0, 7.3, 7.2, 6.2, 6.1, 8.3, 6.4, 7.1, 7.0, 7.5, 7.8, 7…
$ revenue  &lt;dbl&gt; 333130000, 126460000, 138120000, 270320000, 325020000, 451300…</code></pre>
</div>
</div>
<p>The structure of the <code>mutate()</code> call looks like this: first, you need to provide the name of the new variable. If the variable exists already, it will be replaced. Second, the equal sign tells R what the new variable should contain. Third, a function that outputs a vector which is as long as the tibble has rows or 1.</p>
<p>If we want to drop all other columns and just keep the new one: <code>transmute()</code> drops all the original columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">revenue =</span> revenue_million <span class="sc">*</span> <span class="dv">1000000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,000
Columns: 1
$ revenue &lt;dbl&gt; 333130000, 126460000, 138120000, 270320000, 325020000, 4513000…</code></pre>
</div>
</div>
<p><code>mutate()</code> uses so-called <em>window functions</em>. They take one vector of values and return another vector of values. An overview – again, from the cheat sheet:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/window%20functions.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Window functions</figcaption><p></p>
</figure>
</div>
<p>Another feature of <code>dplyr</code>, which is useful in combination with <code>mutate()</code>, is <code>case_when()</code>.</p>
<p><code>case_when()</code> can for instance be used to create binary indicator variables. In this example I want it to be 0 if the movie was made before 2010 and 1 if not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">indicator =</span> <span class="fu">case_when</span>(year <span class="sc">&lt;</span> <span class="dv">2010</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                               year <span class="sc">&gt;=</span> <span class="dv">2010</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                               <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,000
Columns: 8
$ title           &lt;chr&gt; "Guardians of the Galaxy", "Prometheus", "Split", "Sin…
$ director        &lt;chr&gt; "James Gunn", "Ridley Scott", "M. Night Shyamalan", "C…
$ votes           &lt;dbl&gt; 757074, 485820, 157606, 60545, 393727, 56036, 258682, …
$ year            &lt;dbl&gt; 2014, 2012, 2016, 2016, 2016, 2016, 2016, 2016, 2016, …
$ runtime         &lt;dbl&gt; 121, 124, 117, 108, 123, 103, 128, 89, 141, 116, 133, …
$ rating          &lt;dbl&gt; 8.1, 7.0, 7.3, 7.2, 6.2, 6.1, 8.3, 6.4, 7.1, 7.0, 7.5,…
$ revenue_million &lt;dbl&gt; 333.13, 126.46, 138.12, 270.32, 325.02, 45.13, 151.06,…
$ indicator       &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</code></pre>
</div>
</div>
<p>Keep in mind that you can throw any function into <code>mutate()</code> as long as it is vectorized and the output has the same length as the tibble or 1.</p>
</section>
<section id="summarize-and-group_by" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="summarize-and-group_by"><span class="header-section-number">4.1.4</span> <code>summarize()</code> and <code>group_by</code></h3>
<p>When you analyze data, you often want to compare entities according to some sort of summary statistic. This means that you, first, need to split up your data set into certain groups which share one or more characteristics, and, second, collapse the columns together into single-row summaries. The former challenge is accomplished using <code>group_by()</code> whose argument is one or more variables, the latter requires the <code>summarize()</code> function. This function works similar to <code>mutate()</code> but uses <em>summary functions</em> – which take a vector of multiple values and return a single value – instead of window functions – which return a vector of the same length as the input.</p>
<p>Let me provide you an example.</p>
<p>I am interested in the director’s average ratings:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(director) <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_rating =</span> <span class="fu">mean</span>(rating))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 644 × 2
   director            avg_rating
   &lt;chr&gt;                    &lt;dbl&gt;
 1 Aamir Khan                 8.5
 2 Abdellatif Kechiche        7.8
 3 Adam Leon                  6.5
 4 Adam McKay                 7  
 5 Adam Shankman              6.3
 6 Adam Wingard               5.9
 7 Afonso Poyart              6.4
 8 Aisling Walsh              7.8
 9 Akan Satayev               6.3
10 Akiva Schaffer             6.7
# … with 634 more rows</code></pre>
</div>
</div>
<p>In general, <code>summarize()</code> always works like this: first, you change the scope from the entire tibble to different groups. Then, you calculate your summary. If you then want to further manipulate your date or calculate something else based on the new summary, you need to call <code>ungroup()</code>.</p>
<p>You can see the summary functions below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/summary%20functions.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Summary functions in R</figcaption><p></p>
</figure>
</div>
<p>Another handy function akin to this is <code>count()</code>. It counts all occurrences of a singular value in the tibble.</p>
<p>If I were interested in how many movies of the different directors have made it into the data set, I could use this code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(director)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 644 × 2
   director                n
   &lt;chr&gt;               &lt;int&gt;
 1 Aamir Khan              1
 2 Abdellatif Kechiche     1
 3 Adam Leon               1
 4 Adam McKay              4
 5 Adam Shankman           2
 6 Adam Wingard            2
 7 Afonso Poyart           1
 8 Aisling Walsh           1
 9 Akan Satayev            1
10 Akiva Schaffer          1
# … with 634 more rows</code></pre>
</div>
</div>
<p>Beyond that, you can also use <code>group_by()</code> with mutate. If you do so, the rows will not be collapsed together as in <code>summarize()</code>.</p>
</section>
<section id="arrange" class="level3" data-number="4.1.5">
<h3 data-number="4.1.5" class="anchored" data-anchor-id="arrange"><span class="header-section-number">4.1.5</span> <code>arrange()</code></h3>
<p>Finally, you can also sort values using <code>arrange()</code>. In the last section, I was interested in directors’ respective average ratings. The values were ordered according to their name (hence, “Aamir Khan” was first). In this case, the order dos not make too much sense, because the first name does not say too much about the director’s ratings. Therefore, I want to sort them according to their average ratings:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(director) <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_rating =</span> <span class="fu">mean</span>(rating)) <span class="sc">|&gt;</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(avg_rating)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 644 × 2
   director           avg_rating
   &lt;chr&gt;                   &lt;dbl&gt;
 1 Jason Friedberg           1.9
 2 James Wong                2.7
 3 Shawn Burkett             2.7
 4 Jonathan Holbrook         3.2
 5 Femi Oyeniran             3.5
 6 Micheal Bafaro            3.5
 7 Jeffrey G. Hunt           3.7
 8 Rolfe Kanefsky            3.9
 9 Joey Curtis               4  
10 Sam Taylor-Johnson        4.1
# … with 634 more rows</code></pre>
</div>
</div>
<p>All right, Jason Friedberg is apparently the director of the worst rated movie in my data set. But it would be more handy, if they were arranged in descending order. I can use <code>desc()</code> for this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>imdb_selected <span class="sc">|&gt;</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(director) <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_rating =</span> <span class="fu">mean</span>(rating)) <span class="sc">|&gt;</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>avg_rating)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 644 × 2
   director                         avg_rating
   &lt;chr&gt;                                 &lt;dbl&gt;
 1 Nitesh Tiwari                          8.8 
 2 Christopher Nolan                      8.68
 3 Makoto Shinkai                         8.6 
 4 Olivier Nakache                        8.6 
 5 Aamir Khan                             8.5 
 6 Florian Henckel von Donnersmarck       8.5 
 7 Damien Chazelle                        8.4 
 8 Naoko Yamada                           8.4 
 9 Amber Tamblyn                          8.3 
10 Lee Unkrich                            8.3 
# … with 634 more rows</code></pre>
</div>
</div>
<p>Chapeau, Nitesh Tiwari!</p>
</section>
</section>
<section id="introducing-joins" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="introducing-joins"><span class="header-section-number">4.2</span> Introducing <code>joins</code></h2>
<p>The last session showed you three things: how you get data sets into R, a couple of ways to create tibbles, and an introduction to tidy data and how to make data sets tidy using the <code>tidyr</code> package. As you may recall from the last session, it was not able to solve the last two problems with only the tools <code>tidyr</code> offers. In particular, the problems were:</p>
<ul>
<li>Multiple types of observational units are stored in the same table.</li>
<li>A single observational unit is stored in multiple tables.</li>
</ul>
<p>Both problems need some different kind of tools: joins. Joins can be used to merge tibbles together. This tutorial, again, builds heavily on the R for Data Science book <span class="citation" data-cites="wickham_r_2016-1">(<a href="references.html#ref-wickham_r_2016-1" role="doc-biblioref">Wickham and Grolemund 2016</a>)</span></p>
<section id="multiple-types-of-units-are-in-the-same-table" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="multiple-types-of-units-are-in-the-same-table"><span class="header-section-number">4.2.1</span> Multiple types of units are in the same table</h3>
<p>Let’s look at the following data set. It contains the billboard charts in 2000 and was obtained from the <a href="https://github.com/tidyverse/tidyr/blob/master/data/billboard.rda"><code>tidyr</code> GitHub repo</a>. The example below is taken from the <code>tidyr</code> vignette which can be loaded using <code>vignette("tidy-data", package = "tidyr")</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>billboard <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://www.dropbox.com/s/e5gbrpa1fsrtvj5/billboard.csv?dl=1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 317 Columns: 79</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr   (2): artist, track
dbl  (65): wk1, wk2, wk3, wk4, wk5, wk6, wk7, wk8, wk9, wk10, wk11, wk12, wk...
lgl  (11): wk66, wk67, wk68, wk69, wk70, wk71, wk72, wk73, wk74, wk75, wk76
date  (1): date.entered

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(billboard)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 317
Columns: 79
$ artist       &lt;chr&gt; "2 Pac", "2Ge+her", "3 Doors Down", "3 Doors Down", "504 …
$ track        &lt;chr&gt; "Baby Don't Cry (Keep...", "The Hardest Part Of ...", "Kr…
$ date.entered &lt;date&gt; 2000-02-26, 2000-09-02, 2000-04-08, 2000-10-21, 2000-04-…
$ wk1          &lt;dbl&gt; 87, 91, 81, 76, 57, 51, 97, 84, 59, 76, 84, 57, 50, 71, 7…
$ wk2          &lt;dbl&gt; 82, 87, 70, 76, 34, 39, 97, 62, 53, 76, 84, 47, 39, 51, 6…
$ wk3          &lt;dbl&gt; 72, 92, 68, 72, 25, 34, 96, 51, 38, 74, 75, 45, 30, 28, 5…
$ wk4          &lt;dbl&gt; 77, NA, 67, 69, 17, 26, 95, 41, 28, 69, 73, 29, 28, 18, 4…
$ wk5          &lt;dbl&gt; 87, NA, 66, 67, 17, 26, 100, 38, 21, 68, 73, 23, 21, 13, …
$ wk6          &lt;dbl&gt; 94, NA, 57, 65, 31, 19, NA, 35, 18, 67, 69, 18, 19, 13, 3…
$ wk7          &lt;dbl&gt; 99, NA, 54, 55, 36, 2, NA, 35, 16, 61, 68, 11, 20, 11, 34…
$ wk8          &lt;dbl&gt; NA, NA, 53, 59, 49, 2, NA, 38, 14, 58, 65, 9, 17, 1, 29, …
$ wk9          &lt;dbl&gt; NA, NA, 51, 62, 53, 3, NA, 38, 12, 57, 73, 9, 17, 1, 27, …
$ wk10         &lt;dbl&gt; NA, NA, 51, 61, 57, 6, NA, 36, 10, 59, 83, 11, 17, 2, 30,…
$ wk11         &lt;dbl&gt; NA, NA, 51, 61, 64, 7, NA, 37, 9, 66, 92, 1, 17, 2, 36, N…
$ wk12         &lt;dbl&gt; NA, NA, 51, 59, 70, 22, NA, 37, 8, 68, NA, 1, 3, 3, 37, N…
$ wk13         &lt;dbl&gt; NA, NA, 47, 61, 75, 29, NA, 38, 6, 61, NA, 1, 3, 3, 39, N…
$ wk14         &lt;dbl&gt; NA, NA, 44, 66, 76, 36, NA, 49, 1, 67, NA, 1, 7, 4, 49, N…
$ wk15         &lt;dbl&gt; NA, NA, 38, 72, 78, 47, NA, 61, 2, 59, NA, 4, 10, 12, 57,…
$ wk16         &lt;dbl&gt; NA, NA, 28, 76, 85, 67, NA, 63, 2, 63, NA, 8, 17, 11, 63,…
$ wk17         &lt;dbl&gt; NA, NA, 22, 75, 92, 66, NA, 62, 2, 67, NA, 12, 25, 13, 65…
$ wk18         &lt;dbl&gt; NA, NA, 18, 67, 96, 84, NA, 67, 2, 71, NA, 22, 29, 15, 68…
$ wk19         &lt;dbl&gt; NA, NA, 18, 73, NA, 93, NA, 83, 3, 79, NA, 23, 29, 18, 79…
$ wk20         &lt;dbl&gt; NA, NA, 14, 70, NA, 94, NA, 86, 4, 89, NA, 43, 40, 20, 86…
$ wk21         &lt;dbl&gt; NA, NA, 12, NA, NA, NA, NA, NA, 5, NA, NA, 44, 43, 30, NA…
$ wk22         &lt;dbl&gt; NA, NA, 7, NA, NA, NA, NA, NA, 5, NA, NA, NA, 50, 40, NA,…
$ wk23         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 6, NA, NA, NA, NA, 39, NA,…
$ wk24         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 9, NA, NA, NA, NA, 44, NA,…
$ wk25         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 13, NA, NA, NA, NA, NA, NA…
$ wk26         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, 14, NA, NA, NA, NA, NA, NA…
$ wk27         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, 16, NA, NA, NA, NA, NA, NA…
$ wk28         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 23, NA, NA, NA, NA, NA, NA…
$ wk29         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 22, NA, NA, NA, NA, NA, NA…
$ wk30         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 33, NA, NA, NA, NA, NA, NA…
$ wk31         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 36, NA, NA, NA, NA, NA, NA…
$ wk32         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, 43, NA, NA, NA, NA, NA, NA…
$ wk33         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk34         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk35         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk36         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk37         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk38         &lt;dbl&gt; NA, NA, 9, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk39         &lt;dbl&gt; NA, NA, 9, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk40         &lt;dbl&gt; NA, NA, 15, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk41         &lt;dbl&gt; NA, NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk42         &lt;dbl&gt; NA, NA, 13, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk43         &lt;dbl&gt; NA, NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk44         &lt;dbl&gt; NA, NA, 16, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk45         &lt;dbl&gt; NA, NA, 17, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk46         &lt;dbl&gt; NA, NA, 21, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk47         &lt;dbl&gt; NA, NA, 22, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk48         &lt;dbl&gt; NA, NA, 24, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk49         &lt;dbl&gt; NA, NA, 28, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk50         &lt;dbl&gt; NA, NA, 33, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk51         &lt;dbl&gt; NA, NA, 42, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk52         &lt;dbl&gt; NA, NA, 42, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk53         &lt;dbl&gt; NA, NA, 49, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk54         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk55         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk56         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk57         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk58         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk59         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk60         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk61         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk62         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk63         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk64         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk65         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk66         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk67         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk68         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk69         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk70         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk71         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk72         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk73         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk74         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk75         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk76         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
</div>
</div>
<p>Here, you can immediately see the problem: it contains two types of observations: songs and ranks. Hence, the data set needs to be split up. However, there should be a pointer from the rank data set to the song data set. First, I add an ID column to <code>song_tbl</code>. Then, I can add it to <code>rank_tbl</code> and drop the unnecessary columns which contain the name of the artist and the track.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>song_tbl <span class="ot">&lt;-</span> billboard <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(artist, track) <span class="sc">|&gt;</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">song_id =</span> <span class="fu">row_number</span>())</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(song_tbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 317
Columns: 3
$ artist  &lt;chr&gt; "2 Pac", "2Ge+her", "3 Doors Down", "3 Doors Down", "504 Boyz"…
$ track   &lt;chr&gt; "Baby Don't Cry (Keep...", "The Hardest Part Of ...", "Krypton…
$ song_id &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>rank_tbl <span class="ot">&lt;-</span> billboard <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"wk"</span>), </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"week"</span>, </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">"wk"</span>, </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"rank"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">as.numeric</span>(week),</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">date =</span> date.entered <span class="sc">+</span> (week<span class="dv">-1</span>) <span class="sc">*</span> <span class="dv">7</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(song_tbl, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"artist"</span>, <span class="st">"track"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(song_id, date, week, rank)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(rank_tbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,307
Columns: 4
$ song_id &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,…
$ date    &lt;date&gt; 2000-02-26, 2000-03-04, 2000-03-11, 2000-03-18, 2000-03-25, 2…
$ week    &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1…
$ rank    &lt;dbl&gt; 87, 82, 72, 77, 87, 94, 99, 91, 87, 92, 81, 70, 68, 67, 66, 57…</code></pre>
</div>
</div>
</section>
<section id="one-unit-is-in-multiple-tables" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="one-unit-is-in-multiple-tables"><span class="header-section-number">4.2.2</span> One unit is in multiple tables</h3>
<p>For this example, I have split up a data set from the <code>socviz</code> package containing data on the 2016 elections in the U.S. according to census region and stored them in a folder. I can scrape the file names in the folder and read it into a list in an automated manner. (Note that the functions used to read the files in in an automated fashion are beyond the scope of this course. They come from the <a href="https://github.com/r-lib/fs"><code>fs</code></a> <span class="citation" data-cites="hester_fs_2021">(<a href="references.html#ref-hester_fs_2021" role="doc-biblioref">Hester, Wickham, and Csárdi 2021</a>)</span> and the <a href="https://r4ds.had.co.nz/iteration.html"><code>purrr</code></a> package <span class="citation" data-cites="henry_purrr_2020">(<a href="references.html#ref-henry_purrr_2020" role="doc-biblioref"><strong>henry_purrr_2020?</strong></a>)</span>.)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>file_list <span class="ot">&lt;-</span> <span class="fu">dir_ls</span>(<span class="at">path =</span> <span class="st">"data/socviz_us"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(read_csv,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">id =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">state =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">census_region =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">pop_dens =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">pop_dens4 =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">pop_dens6 =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">pct_black =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">pop =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">female =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">white =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">black =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">travel_time =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">land_area =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">hh_income =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">su_gun4 =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">su_gun6 =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">fips =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">votes_dem_2016 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">votes_gop_2016 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">total_votes_2016 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">per_dem_2016 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">per_gop_2016 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">diff_2016 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">per_dem_2012 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">per_gop_2012 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">diff_2012 =</span> <span class="fu">col_double</span>(),</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">winner =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">partywinner16 =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">winner12 =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">partywinner12 =</span> <span class="fu">col_character</span>(),</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">flipped =</span> <span class="fu">col_character</span>()</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The list now consists of four tibbles which need to be bound together. You can achieve this using <code>bind_rows()</code>. Its counterpart is <code>bind_cols()</code> which binds columns together. It matches rows by position.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>election_data <span class="ot">&lt;-</span> file_list <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(election_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,141
Columns: 32
$ id               &lt;dbl&gt; 17001, 17003, 17005, 17007, 17009, 17011, 17013, 1701…
$ name             &lt;chr&gt; "Adams County", "Alexander County", "Bond County", "B…
$ state            &lt;chr&gt; "IL", "IL", "IL", "IL", "IL", "IL", "IL", "IL", "IL",…
$ census_region    &lt;chr&gt; "Midwest", "Midwest", "Midwest", "Midwest", "Midwest"…
$ pop_dens         &lt;chr&gt; "[   50,  100)", "[   10,   50)", "[   10,   50)", "[…
$ pop_dens4        &lt;chr&gt; "[ 45,  118)", "[ 17,   45)", "[ 45,  118)", "[118,71…
$ pop_dens6        &lt;chr&gt; "[ 45,   82)", "[ 25,   45)", "[ 45,   82)", "[ 82,  …
$ pct_black        &lt;chr&gt; "[ 2.0, 5.0)", "[25.0,50.0)", "[ 5.0,10.0)", "[ 2.0, …
$ pop              &lt;dbl&gt; 66988, 7492, 17269, 53869, 6832, 33840, 4956, 14715, …
$ female           &lt;dbl&gt; 51.3, 49.5, 47.5, 50.2, 35.5, 51.0, 49.7, 50.1, 49.1,…
$ white            &lt;dbl&gt; 93.7, 60.6, 90.9, 93.2, 78.6, 96.8, 98.8, 96.7, 93.2,…
$ black            &lt;dbl&gt; 3.7, 36.1, 6.5, 2.6, 19.1, 0.8, 0.3, 1.1, 4.4, 12.8, …
$ travel_time      &lt;dbl&gt; 16.6, 25.6, 23.6, 30.1, 18.9, 20.4, 39.6, 23.8, 22.2,…
$ land_area        &lt;dbl&gt; 855.20, 235.51, 380.28, 280.72, 305.61, 869.03, 253.8…
$ hh_income        &lt;dbl&gt; 45073, 26972, 48163, 60893, 42194, 48977, 50436, 4798…
$ su_gun4          &lt;chr&gt; "[ 0, 5)", "[ 5, 8)", "[ 0, 5)", "[ 0, 5)", "[ 0, 5)"…
$ su_gun6          &lt;chr&gt; "[ 4, 7)", "[ 7, 8)", "[ 4, 7)", "[ 0, 4)", "[ 0, 4)"…
$ fips             &lt;dbl&gt; 17001, 17003, 17005, 17007, 17009, 17011, 17013, 1701…
$ votes_dem_2016   &lt;dbl&gt; 7633, 1262, 2066, 8952, 475, 6010, 739, 2437, 1617, 4…
$ votes_gop_2016   &lt;dbl&gt; 22732, 1496, 4884, 12261, 1776, 9264, 1719, 4428, 321…
$ total_votes_2016 &lt;dbl&gt; 31770, 2820, 7462, 22604, 2336, 16303, 2556, 7354, 50…
$ per_dem_2016     &lt;dbl&gt; 0.2402581, 0.4475177, 0.2768695, 0.3960361, 0.2033390…
$ per_gop_2016     &lt;dbl&gt; 0.7155178, 0.5304965, 0.6545162, 0.5424261, 0.7602740…
$ diff_2016        &lt;dbl&gt; 15099, 234, 2818, 3309, 1301, 3254, 980, 1991, 1599, …
$ per_dem_2012     &lt;dbl&gt; 0.3152466, 0.5610873, 0.4122471, 0.4625697, 0.3331922…
$ per_gop_2012     &lt;dbl&gt; 0.6670705, 0.4248927, 0.5591853, 0.5195706, 0.6397121…
$ diff_2012        &lt;dbl&gt; 10744, 476, 1075, 1216, 724, 33, 360, 107, 657, 5292,…
$ winner           &lt;chr&gt; "Trump", "Trump", "Trump", "Trump", "Trump", "Trump",…
$ partywinner16    &lt;chr&gt; "Republican", "Republican", "Republican", "Republican…
$ winner12         &lt;chr&gt; "Romney", "Obama", "Romney", "Romney", "Romney", "Rom…
$ partywinner12    &lt;chr&gt; "Republican", "Democrat", "Republican", "Republican",…
$ flipped          &lt;chr&gt; "No", "Yes", "No", "No", "No", "No", "No", "Yes", "No…</code></pre>
</div>
</div>
<p>Now, the data set is ready for cleaning and tidying. Feel free to do this is as a take-home exercise.</p>
<p>However, the topic of this script is different joins. The <code>dplyr</code> package offers six different joins: <code>left_join()</code>, <code>right_join()</code>, <code>inner_join()</code>, <code>full_join()</code>, <code>semi_join()</code>, and <code>anti_join()</code>. The former four are mutating joins, they add columns. The latter two can be used to filter rows in a data set. Below is an overview from the <code>dplyr</code> cheat sheet:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/joins.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Overview of the different joins</figcaption><p></p>
</figure>
</div>
<p>In the following, I will illustrate this using the election data. I split up the data set into three: data on the elections 2016 and 2012, and demographic data. The column they have in common is the county’s respective name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>election_data16 <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, state, votes_dem_2016<span class="sc">:</span>diff_2016, winner, partywinner16)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>election_data12 <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, state, per_dem_2012<span class="sc">:</span>partywinner12)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>demographic_data <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, state, pop<span class="sc">:</span>hh_income) <span class="sc">|&gt;</span> </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="left_join-and-right_join" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="left_join-and-right_join"><span class="header-section-number">4.2.3</span> <code>left_join()</code> and <code>right_join()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>election_data16 <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(demographic_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("name", "state")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,141 × 17
   name     state votes…¹ votes…² total…³ per_d…⁴ per_g…⁵ diff_…⁶ winner party…⁷
   &lt;chr&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  
 1 Adams C… IL       7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 2 Alexand… IL       1262    1496    2820   0.448   0.530     234 Trump  Republ…
 3 Bond Co… IL       2066    4884    7462   0.277   0.655    2818 Trump  Republ…
 4 Boone C… IL       8952   12261   22604   0.396   0.542    3309 Trump  Republ…
 5 Brown C… IL        475    1776    2336   0.203   0.760    1301 Trump  Republ…
 6 Bureau … IL       6010    9264   16303   0.369   0.568    3254 Trump  Republ…
 7 Calhoun… IL        739    1719    2556   0.289   0.673     980 Trump  Republ…
 8 Carroll… IL       2437    4428    7354   0.331   0.602    1991 Trump  Republ…
 9 Cass Co… IL       1617    3216    5054   0.320   0.636    1599 Trump  Republ…
10 Champai… IL      49694   33235   89196   0.557   0.373   16459 Clint… Democr…
# … with 3,131 more rows, 7 more variables: pop &lt;dbl&gt;, female &lt;dbl&gt;,
#   white &lt;dbl&gt;, black &lt;dbl&gt;, travel_time &lt;dbl&gt;, land_area &lt;dbl&gt;,
#   hh_income &lt;dbl&gt;, and abbreviated variable names ¹​votes_dem_2016,
#   ²​votes_gop_2016, ³​total_votes_2016, ⁴​per_dem_2016, ⁵​per_gop_2016,
#   ⁶​diff_2016, ⁷​partywinner16</code></pre>
</div>
</div>
<p>If the column that both data sets have in common has the same name, there’s no need to provide it. If this is not the case, you need to provide it in a character vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>election_data16 <span class="sc">|&gt;</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">county =</span> name) <span class="sc">|&gt;</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(demographic_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"county"</span> <span class="ot">=</span> <span class="st">"name"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,348 × 18
   county state.x votes…¹ votes…² total…³ per_d…⁴ per_g…⁵ diff_…⁶ winner party…⁷
   &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  
 1 Adams… IL         7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 2 Adams… IL         7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 3 Adams… IL         7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 4 Adams… IL         7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 5 Adams… IL         7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 6 Adams… IL         7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 7 Adams… IL         7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 8 Adams… IL         7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 9 Adams… IL         7633   22732   31770   0.240   0.716   15099 Trump  Republ…
10 Alexa… IL         1262    1496    2820   0.448   0.530     234 Trump  Republ…
# … with 10,338 more rows, 8 more variables: state.y &lt;chr&gt;, pop &lt;dbl&gt;,
#   female &lt;dbl&gt;, white &lt;dbl&gt;, black &lt;dbl&gt;, travel_time &lt;dbl&gt;, land_area &lt;dbl&gt;,
#   hh_income &lt;dbl&gt;, and abbreviated variable names ¹​votes_dem_2016,
#   ²​votes_gop_2016, ³​total_votes_2016, ⁴​per_dem_2016, ⁵​per_gop_2016,
#   ⁶​diff_2016, ⁷​partywinner16</code></pre>
</div>
</div>
<p>Here, the problem is that the same counties exist in different states. Therefore, all combinations are returned. Hence, I need to specify two arguments: the county’s name and state.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>election_data16 <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">county =</span> name) <span class="sc">|&gt;</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(demographic_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"county"</span> <span class="ot">=</span> <span class="st">"name"</span>, <span class="st">"state"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,000 × 17
   county   state votes…¹ votes…² total…³ per_d…⁴ per_g…⁵ diff_…⁶ winner party…⁷
   &lt;chr&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  
 1 Adams C… IL       7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 2 Alexand… IL       1262    1496    2820   0.448   0.530     234 Trump  Republ…
 3 Bond Co… IL       2066    4884    7462   0.277   0.655    2818 Trump  Republ…
 4 Boone C… IL       8952   12261   22604   0.396   0.542    3309 Trump  Republ…
 5 Brown C… IL        475    1776    2336   0.203   0.760    1301 Trump  Republ…
 6 Bureau … IL       6010    9264   16303   0.369   0.568    3254 Trump  Republ…
 7 Calhoun… IL        739    1719    2556   0.289   0.673     980 Trump  Republ…
 8 Carroll… IL       2437    4428    7354   0.331   0.602    1991 Trump  Republ…
 9 Cass Co… IL       1617    3216    5054   0.320   0.636    1599 Trump  Republ…
10 Champai… IL      49694   33235   89196   0.557   0.373   16459 Clint… Democr…
# … with 1,990 more rows, 7 more variables: pop &lt;dbl&gt;, female &lt;dbl&gt;,
#   white &lt;dbl&gt;, black &lt;dbl&gt;, travel_time &lt;dbl&gt;, land_area &lt;dbl&gt;,
#   hh_income &lt;dbl&gt;, and abbreviated variable names ¹​votes_dem_2016,
#   ²​votes_gop_2016, ³​total_votes_2016, ⁴​per_dem_2016, ⁵​per_gop_2016,
#   ⁶​diff_2016, ⁷​partywinner16</code></pre>
</div>
</div>
<p>Left joins return all rows which are in <code>x</code>. If a column is in <code>x</code> but not in <code>y</code>, an <code>NA</code> will be included at this position. Right joins work vice versa.</p>
</section>
<section id="inner_join" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="inner_join"><span class="header-section-number">4.2.4</span> <code>inner_join()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>election_data16 <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(demographic_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("name", "state")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,000 × 17
   name     state votes…¹ votes…² total…³ per_d…⁴ per_g…⁵ diff_…⁶ winner party…⁷
   &lt;chr&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  
 1 Adams C… IL       7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 2 Alexand… IL       1262    1496    2820   0.448   0.530     234 Trump  Republ…
 3 Bond Co… IL       2066    4884    7462   0.277   0.655    2818 Trump  Republ…
 4 Boone C… IL       8952   12261   22604   0.396   0.542    3309 Trump  Republ…
 5 Brown C… IL        475    1776    2336   0.203   0.760    1301 Trump  Republ…
 6 Bureau … IL       6010    9264   16303   0.369   0.568    3254 Trump  Republ…
 7 Calhoun… IL        739    1719    2556   0.289   0.673     980 Trump  Republ…
 8 Carroll… IL       2437    4428    7354   0.331   0.602    1991 Trump  Republ…
 9 Cass Co… IL       1617    3216    5054   0.320   0.636    1599 Trump  Republ…
10 Champai… IL      49694   33235   89196   0.557   0.373   16459 Clint… Democr…
# … with 1,990 more rows, 7 more variables: pop &lt;dbl&gt;, female &lt;dbl&gt;,
#   white &lt;dbl&gt;, black &lt;dbl&gt;, travel_time &lt;dbl&gt;, land_area &lt;dbl&gt;,
#   hh_income &lt;dbl&gt;, and abbreviated variable names ¹​votes_dem_2016,
#   ²​votes_gop_2016, ³​total_votes_2016, ⁴​per_dem_2016, ⁵​per_gop_2016,
#   ⁶​diff_2016, ⁷​partywinner16</code></pre>
</div>
</div>
<p>An <code>inner_join()</code> returns all rows which are in <code>x</code> and <code>y</code>.</p>
</section>
<section id="full_join" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="full_join"><span class="header-section-number">4.2.5</span> <code>full_join()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>election_data16 <span class="sc">|&gt;</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(demographic_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("name", "state")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,141 × 17
   name     state votes…¹ votes…² total…³ per_d…⁴ per_g…⁵ diff_…⁶ winner party…⁷
   &lt;chr&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  
 1 Adams C… IL       7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 2 Alexand… IL       1262    1496    2820   0.448   0.530     234 Trump  Republ…
 3 Bond Co… IL       2066    4884    7462   0.277   0.655    2818 Trump  Republ…
 4 Boone C… IL       8952   12261   22604   0.396   0.542    3309 Trump  Republ…
 5 Brown C… IL        475    1776    2336   0.203   0.760    1301 Trump  Republ…
 6 Bureau … IL       6010    9264   16303   0.369   0.568    3254 Trump  Republ…
 7 Calhoun… IL        739    1719    2556   0.289   0.673     980 Trump  Republ…
 8 Carroll… IL       2437    4428    7354   0.331   0.602    1991 Trump  Republ…
 9 Cass Co… IL       1617    3216    5054   0.320   0.636    1599 Trump  Republ…
10 Champai… IL      49694   33235   89196   0.557   0.373   16459 Clint… Democr…
# … with 3,131 more rows, 7 more variables: pop &lt;dbl&gt;, female &lt;dbl&gt;,
#   white &lt;dbl&gt;, black &lt;dbl&gt;, travel_time &lt;dbl&gt;, land_area &lt;dbl&gt;,
#   hh_income &lt;dbl&gt;, and abbreviated variable names ¹​votes_dem_2016,
#   ²​votes_gop_2016, ³​total_votes_2016, ⁴​per_dem_2016, ⁵​per_gop_2016,
#   ⁶​diff_2016, ⁷​partywinner16</code></pre>
</div>
</div>
<p>A <code>full_join()</code> returns rows and columns from both <code>x</code> and <code>y</code>.</p>
</section>
<section id="semi_join" class="level3" data-number="4.2.6">
<h3 data-number="4.2.6" class="anchored" data-anchor-id="semi_join"><span class="header-section-number">4.2.6</span> <code>semi_join()</code></h3>
<p>Filtering joins only keep the cases from <code>x</code>, no data set is added.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>election_data16 <span class="sc">|&gt;</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(demographic_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("name", "state")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,000 × 10
   name     state votes…¹ votes…² total…³ per_d…⁴ per_g…⁵ diff_…⁶ winner party…⁷
   &lt;chr&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  
 1 Adams C… IL       7633   22732   31770   0.240   0.716   15099 Trump  Republ…
 2 Alexand… IL       1262    1496    2820   0.448   0.530     234 Trump  Republ…
 3 Bond Co… IL       2066    4884    7462   0.277   0.655    2818 Trump  Republ…
 4 Boone C… IL       8952   12261   22604   0.396   0.542    3309 Trump  Republ…
 5 Brown C… IL        475    1776    2336   0.203   0.760    1301 Trump  Republ…
 6 Bureau … IL       6010    9264   16303   0.369   0.568    3254 Trump  Republ…
 7 Calhoun… IL        739    1719    2556   0.289   0.673     980 Trump  Republ…
 8 Carroll… IL       2437    4428    7354   0.331   0.602    1991 Trump  Republ…
 9 Cass Co… IL       1617    3216    5054   0.320   0.636    1599 Trump  Republ…
10 Champai… IL      49694   33235   89196   0.557   0.373   16459 Clint… Democr…
# … with 1,990 more rows, and abbreviated variable names ¹​votes_dem_2016,
#   ²​votes_gop_2016, ³​total_votes_2016, ⁴​per_dem_2016, ⁵​per_gop_2016,
#   ⁶​diff_2016, ⁷​partywinner16</code></pre>
</div>
</div>
<p>The <code>semi_join()</code> returns all rows from <code>x</code> with matching values in <code>y</code>. You can compare it to a <code>right_join()</code> but without adding the columns of <code>y</code>.</p>
</section>
<section id="anti_join" class="level3" data-number="4.2.7">
<h3 data-number="4.2.7" class="anchored" data-anchor-id="anti_join"><span class="header-section-number">4.2.7</span> <code>anti_join()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>election_data16 <span class="sc">|&gt;</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(demographic_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("name", "state")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,141 × 10
   name     state votes…¹ votes…² total…³ per_d…⁴ per_g…⁵ diff_…⁶ winner party…⁷
   &lt;chr&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  
 1 Onslow … NC      17156   36342   55364   0.310   0.656   19186 Trump  Republ…
 2 Orange … NC      59105   18373   79830   0.740   0.230   40732 Clint… Democr…
 3 Pamlico… NC       2427    4225    6772   0.358   0.624    1798 Trump  Republ…
 4 Pasquot… NC       8455    8082   16964   0.498   0.476     373 Clint… Democr…
 5 Pender … NC       9086   17317   27072   0.336   0.640    8231 Trump  Republ…
 6 Perquim… NC       2291    4143    6595   0.347   0.628    1852 Trump  Republ…
 7 Person … NC       7772   11116   19303   0.403   0.576    3344 Trump  Republ…
 8 Pitt Co… NC      40967   35191   78264   0.523   0.450    5776 Clint… Democr…
 9 Polk Co… NC       3715    6738   10723   0.346   0.628    3023 Trump  Republ…
10 Randolp… NC      13074   49156   63615   0.206   0.773   36082 Trump  Republ…
# … with 1,131 more rows, and abbreviated variable names ¹​votes_dem_2016,
#   ²​votes_gop_2016, ³​total_votes_2016, ⁴​per_dem_2016, ⁵​per_gop_2016,
#   ⁶​diff_2016, ⁷​partywinner16</code></pre>
</div>
</div>
<p><code>anti_join()</code> returns all rows from <code>x</code> with no matching rows in <code>y</code>.</p>
</section>
<section id="bind_rows-and-bind_cols" class="level3" data-number="4.2.8">
<h3 data-number="4.2.8" class="anchored" data-anchor-id="bind_rows-and-bind_cols"><span class="header-section-number">4.2.8</span> <code>bind_rows()</code> and <code>bind_cols()</code></h3>
<p>Binding tibbles together is made easy using the <code>bind_*()</code> functions. <code>bind_rows()</code> binds them together by rows, <code>bind_cols()</code> by columns. For the former, it is important that column names are matching. Otherwise, the non-matching ones will be added as separate columns and NAs introduced. IDs can be added by using the <code>.id =</code> argument, where the name of the id column can be specified.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>election_data16 <span class="sc">|&gt;</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(demographic_data) <span class="sc">|&gt;</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(election_data16 <span class="sc">|&gt;</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">anti_join</span>(demographic_data),</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">.id =</span> <span class="st">"id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = c("name", "state")
Joining, by = c("name", "state")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,141 × 11
   id    name       state votes…¹ votes…² total…³ per_d…⁴ per_g…⁵ diff_…⁶ winner
   &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; 
 1 1     Adams Cou… IL       7633   22732   31770   0.240   0.716   15099 Trump 
 2 1     Alexander… IL       1262    1496    2820   0.448   0.530     234 Trump 
 3 1     Bond Coun… IL       2066    4884    7462   0.277   0.655    2818 Trump 
 4 1     Boone Cou… IL       8952   12261   22604   0.396   0.542    3309 Trump 
 5 1     Brown Cou… IL        475    1776    2336   0.203   0.760    1301 Trump 
 6 1     Bureau Co… IL       6010    9264   16303   0.369   0.568    3254 Trump 
 7 1     Calhoun C… IL        739    1719    2556   0.289   0.673     980 Trump 
 8 1     Carroll C… IL       2437    4428    7354   0.331   0.602    1991 Trump 
 9 1     Cass Coun… IL       1617    3216    5054   0.320   0.636    1599 Trump 
10 1     Champaign… IL      49694   33235   89196   0.557   0.373   16459 Clint…
# … with 3,131 more rows, 1 more variable: partywinner16 &lt;chr&gt;, and abbreviated
#   variable names ¹​votes_dem_2016, ²​votes_gop_2016, ³​total_votes_2016,
#   ⁴​per_dem_2016, ⁵​per_gop_2016, ⁶​diff_2016</code></pre>
</div>
</div>
<p>For <code>bind_cols()</code>, the length has to be the same. Duplicated column names will be changed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>election_data12 <span class="sc">|&gt;</span> <span class="fu">bind_cols</span>(election_data16)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `name` -&gt; `name...1`
• `state` -&gt; `state...2`
• `winner` -&gt; `winner...6`
• `partywinner16` -&gt; `partywinner16...7`
• `name` -&gt; `name...10`
• `state` -&gt; `state...11`
• `winner` -&gt; `winner...18`
• `partywinner16` -&gt; `partywinner16...19`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,141 × 19
   name...1      state…¹ per_d…² per_g…³ diff_…⁴ winne…⁵ party…⁶ winne…⁷ party…⁸
   &lt;chr&gt;         &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
 1 Adams County  IL        0.315   0.667   10744 Trump   Republ… Romney  Republ…
 2 Alexander Co… IL        0.561   0.425     476 Trump   Republ… Obama   Democr…
 3 Bond County   IL        0.412   0.559    1075 Trump   Republ… Romney  Republ…
 4 Boone County  IL        0.463   0.520    1216 Trump   Republ… Romney  Republ…
 5 Brown County  IL        0.333   0.640     724 Trump   Republ… Romney  Republ…
 6 Bureau County IL        0.489   0.491      33 Trump   Republ… Romney  Republ…
 7 Calhoun Coun… IL        0.419   0.559     360 Trump   Republ… Romney  Republ…
 8 Carroll Coun… IL        0.496   0.482     107 Trump   Republ… Obama   Democr…
 9 Cass County   IL        0.422   0.557     657 Trump   Republ… Romney  Republ…
10 Champaign Co… IL        0.520   0.452    5292 Clinton Democr… Obama   Democr…
# … with 3,131 more rows, 10 more variables: name...10 &lt;chr&gt;, state...11 &lt;chr&gt;,
#   votes_dem_2016 &lt;dbl&gt;, votes_gop_2016 &lt;dbl&gt;, total_votes_2016 &lt;dbl&gt;,
#   per_dem_2016 &lt;dbl&gt;, per_gop_2016 &lt;dbl&gt;, diff_2016 &lt;dbl&gt;, winner...18 &lt;chr&gt;,
#   partywinner16...19 &lt;chr&gt;, and abbreviated variable names ¹​state...2,
#   ²​per_dem_2012, ³​per_gop_2012, ⁴​diff_2012, ⁵​winner...6, ⁶​partywinner16...7,
#   ⁷​winner12, ⁸​partywinner12</code></pre>
</div>
</div>
</section>
</section>
<section id="further-links" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="further-links"><span class="header-section-number">4.3</span> Further links</h2>
<ul>
<li><a href="https://r4ds.had.co.nz/transform.html">Chapter in R4DS</a></li>
<li>More on window functions in the vignette: <code>vignette("window-functions")</code></li>
<li>Again, <a href="https://github.com/rstudio/cheatsheets/blob/master/data-transformation.pdf">the cheatsheet</a></li>
<li>A <a href="https://www.youtube.com/watch?v=jWjqLW-u3hc">tutorial on YouTube</a></li>
<li>Another introduction can be found <a href="https://stat545.com/join-cheatsheet.html">here</a>.</li>
<li>The <a href="https://r4ds.had.co.nz/relational-data.html">chapter in R4DS</a> has some nice diagrams.</li>
<li>You can also consult the <code>introverse</code> package if you need help with the packages covered here – <code>introverse::show_topics("dplyr")</code> will give you an overview of <code>dplyr</code>’s functions, and <code>get_help("name of function")</code> will help you with the respective function.</li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-hester_fs_2021" class="csl-entry" role="doc-biblioentry">
Hester, Jim, Hadley Wickham, and Gábor Csárdi. 2021. <span>“Fs: <span>Cross-Platform File System Operations Based</span> on ’Libuv’.”</span>
</div>
<div id="ref-wickham_dplyr_2020" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley. 2020a. <span>“Dplyr: <span>A Grammar</span> of <span>Data Manipulation</span>.”</span>
</div>
<div id="ref-wickham_tidyr_2020" class="csl-entry" role="doc-biblioentry">
———. 2020b. <span>“Tidyr: <span>Tidy Messy Data</span>.”</span>
</div>
<div id="ref-wickham_welcome_2019" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span>Tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-wickham_r_2016-1" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, and Garrett Grolemund. 2016. <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em>. First edition. <span>Sebastopol, CA</span>: <span>O’Reilly</span>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>If you want the code on your machine, download the files behind the following links and store them in a folder called <code>socviz_us</code> which is again stored in a folder named <code>data</code> which lives in the same folder as the .qmd file. https://www.dropbox.com/s/14k6bkmaq6l47p2/midwest.csv?dl=0 ; https://www.dropbox.com/s/t3057jf9evt6vjz/northeast.csv?dl=0 ; https://www.dropbox.com/s/lbdde4udlrfea46/south.csv?dl=0 ; https://www.dropbox.com/s/vcvl90dbegagv4z/west.csv?dl=0<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./tidy-data.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tidy data with <code>tidyr</code></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./forcats.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Factors with <code>forcats</code></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>